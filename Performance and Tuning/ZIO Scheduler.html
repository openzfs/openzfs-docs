

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta property="article:modified_time" content="2025-12-02T16:53:55+00:00" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ZFS I/O (ZIO) Scheduler &mdash; OpenZFS  documentation</title>
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/mandoc.css" type="text/css" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="https://openzfs.github.io/openzfs-docs/Performance%20and%20Tuning/ZIO%20Scheduler.html" />
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="../_static/js/redirect.js?v=2a1712f3"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Basic Concepts" href="../Basic%20Concepts/index.html" />
    <link rel="prev" title="OpenZFS Transaction Delay" href="ZFS%20Transaction%20Delay.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #29667e" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo_main.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Getting%20Started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Project%20and%20Community/index.html">Project and Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Developer%20Resources/index.html">Developer Resources</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Performance and Tuning</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Hardware.html">Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="Module%20Parameters.html">Module Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="Workload%20Tuning.html">Workload Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="ZFS%20Transaction%20Delay.html">OpenZFS Transaction Delay</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">ZFS I/O (ZIO) Scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="#async-write-i-o-scheduling">Async Write I/O Scheduling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Basic%20Concepts/index.html">Basic Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../man/index.html">Man Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../msg/index.html">ZFS Messages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../License.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #29667e" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OpenZFS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Performance and Tuning</a></li>
      <li class="breadcrumb-item active">ZFS I/O (ZIO) Scheduler</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/openzfs/openzfs-docs/blob/master/docs/Performance and Tuning/ZIO Scheduler.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="zfs-i-o-zio-scheduler">
<h1>ZFS I/O (ZIO) Scheduler<a class="headerlink" href="#zfs-i-o-zio-scheduler" title="Link to this heading"></a></h1>
<p>ZFS issues I/O operations to leaf <a class="reference external" href="https://openzfs.github.io/openzfs-docs/Basic%20Concepts/VDEVs.html">vdevs</a>
(usually devices) to satisfy and complete I/Os. The ZIO scheduler determines when and in what order those
operations are issued. Operations are divided into nine I/O classes
prioritized in the following order:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Priority</p></th>
<th class="head"><p>I/O Class</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>I/O Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>highest</p></td>
<td><p>sync read</p></td>
<td><p>most reads</p></td>
<td><p>interactive</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>sync write</p></td>
<td><p>as defined by application or via ‘zfs’
‘sync’ property</p></td>
<td><p>interactive</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>async read</p></td>
<td><p>prefetch reads</p></td>
<td><p>interactive</p></td>
</tr>
<tr class="row-odd"><td><p>see below</p></td>
<td><p>async write</p></td>
<td><p>most writes</p></td>
<td><p>interactive</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>scrub read</p></td>
<td><p>scan reads: includes both scrub and
resilver</p></td>
<td><p>non-interactive</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>removal</p></td>
<td><p>vdev removal reflow</p></td>
<td><p>non-interactive</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>initializing</p></td>
<td><p>vdev space initialization</p></td>
<td><p>non-interactive</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>trim</p></td>
<td><p>TRIM/UNMAP requests</p></td>
<td><p>interactive</p></td>
</tr>
<tr class="row-even"><td><p>lowest</p></td>
<td><p>rebuild</p></td>
<td><p>sequential reconstruction</p></td>
<td><p>non-interactive</p></td>
</tr>
</tbody>
</table>
<p>For interactive I/Os each queue defines the minimum and maximum number of concurrent
operations issued to the device. Each device also respects an aggregate maximum - <a class="reference external" href="https://openzfs.github.io/openzfs-docs/Performance%20and%20Tuning/Module%20Parameters.html#zfs-vdev-max-active">zfs_vdev_max_active</a>.
Note that the sum of the per-queue minimums must not exceed the aggregate maximum.
If the sum of the per-queue maximums exceeds the aggregate maximum, then the number of
active I/Os may reach <a class="reference external" href="https://openzfs.github.io/openzfs-docs/Performance%20and%20Tuning/Module%20Parameters.html#zfs-vdev-max-active">zfs_vdev_max_active</a>,
in which case no further I/Os are issued regardless of whether all per-queue minimums have been met.</p>
<p>For non-interactive I/O (scrub, resilver, removal, initializing, and rebuild),
the number of concurrently-active I/Os is limited to _min_active, unless
the vdev is “idle”. When there are no interactive I/Os active (sync or
async), and <a class="reference external" href="https://openzfs.github.io/openzfs-docs/Performance%20and%20Tuning/Module%20Parameters.html#zfs-vdev-nia-delay">zfs_vdev_nia_delay</a>
I/Os have completed since the last interactive I/O, then the vdev is considered to be “idle”, and the number
of concurrently-active non-interactive I/Os is increased to _max_active.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>I/O Class</p></th>
<th class="head"><p>Min Active Parameter</p></th>
<th class="head"><p>Max Active Parameter</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sync read</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_sync_read_min_active</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_sync_read_max_active</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>sync write</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_sync_write_min_active</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_sync_write_max_active</span></code></p></td>
</tr>
<tr class="row-even"><td><p>async read</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_async_read_min_active</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_async_read_max_active</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>async write</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_async_write_min_active</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_async_write_max_active</span></code></p></td>
</tr>
<tr class="row-even"><td><p>scrub read</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_scrub_min_active</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_scrub_max_active</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>removal</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_removal_min_active</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_removal_max_active</span></code></p></td>
</tr>
<tr class="row-even"><td><p>initializing</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_initializing_min_active</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_initializing_max_active</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>trim</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_trim_min_active</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_trim_max_active</span></code></p></td>
</tr>
<tr class="row-even"><td><p>rebuild</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_rebuild_min_active</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">zfs_vdev_rebuild_max_active</span></code></p></td>
</tr>
</tbody>
</table>
<p>I/O queue statistics include most of the I/Os classes and can be viewed via
the <a class="reference external" href="https://openzfs.github.io/openzfs-docs/man/master/8/zpool-iostat.8.html#q">zpool iostat -q</a> command</p>
<p>For many physical devices, throughput increases with the number of
concurrent operations, but latency typically suffers. Further, physical
devices typically have a limit at which more concurrent operations have
no effect on throughput or can cause the disk performance to
decrease.</p>
<p>The ZIO scheduler selects the next operation to issue by first looking
for an I/O class whose minimum has not been satisfied. Once all are
satisfied and the aggregate maximum has not been hit, the scheduler
looks for classes whose maximum has not been satisfied. Iteration
through the I/O classes is done in the order specified above. No further
operations are issued if the aggregate maximum number of concurrent
operations has been hit or if there are no operations queued for an I/O
class that has not hit its maximum. Every time an I/O is queued or an
operation completes, the I/O scheduler looks for new operations to
issue.</p>
<p>In general, smaller max_active’s will lead to lower latency of
synchronous operations. Larger max_active’s may lead to higher overall
throughput, depending on underlying storage and the I/O mix.</p>
<p>The ratio of the queues’ max_actives determines the balance of
performance between reads, writes, and scrubs. For example, when there
is contention, increasing zfs_vdev_scrub_max_active will cause the scrub
or resilver to complete more quickly, but reads and writes to have
higher latency and lower throughput.</p>
<p>All I/O classes have a fixed maximum number of outstanding operations
except for the async write class. Asynchronous writes represent the data
that is committed to stable storage during the syncing stage for
transaction groups. Transaction groups enter the syncing state
periodically so the number of queued async writes quickly bursts up and
then reduce down to zero. The zfs_txg_timeout tunable (default=5
seconds) sets the target interval for txg sync. Thus a burst of async
writes every 5 seconds is a normal ZFS I/O pattern.</p>
<p>Rather than servicing I/Os as quickly as possible, the ZIO scheduler
changes the maximum number of active async write I/Os according to the
amount of dirty data in the pool. Since both throughput and latency
typically increase as the number of concurrent operations issued to
physical devices, reducing the burstiness in the number of concurrent
operations also stabilizes the response time of operations from other
queues. This is particularly important for the sync read and write queues,
where the periodic async write bursts of the txg sync can lead to
device-level contention. In broad strokes, the ZIO scheduler issues more
concurrent operations from the async write queue as there’s more dirty
data in the pool.</p>
</section>
<section id="async-write-i-o-scheduling">
<h1>Async Write I/O Scheduling<a class="headerlink" href="#async-write-i-o-scheduling" title="Link to this heading"></a></h1>
<p>The number of concurrent operations issued for the async write I/O class
follows a piece-wise linear function defined by a few adjustable points:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>       |                   o---------| &lt;-- zfs_vdev_async_write_max_active
  ^    |                  /^         |
  |    |                 / |         |
active |                /  |         |
 I/O   |               /   |         |
count  |              /    |         |
       |             /     |         |
       |------------o      |         | &lt;-- zfs_vdev_async_write_min_active
      0|____________^______|_________|
       0%           |      |        100% of zfs_dirty_data_max
                    |      |
                    |      `-- zfs_vdev_async_write_active_max_dirty_percent
                    `--------- zfs_vdev_async_write_active_min_dirty_percent
</pre></div>
</div>
<p>Until the amount of dirty data exceeds a minimum percentage of the dirty
data allowed in the pool, the I/O scheduler will limit the number of
concurrent operations to the minimum. As that threshold is crossed, the
number of concurrent operations issued increases linearly to the maximum at
the specified maximum percentage of the dirty data allowed in the pool.</p>
<p>Ideally, the amount of dirty data on a busy pool will stay in the sloped
part of the function between zfs_vdev_async_write_active_min_dirty_percent
and zfs_vdev_async_write_active_max_dirty_percent. If it exceeds the
maximum percentage, this indicates that the rate of incoming data is
greater than the rate that the backend storage can handle. In this case, we
must further throttle incoming writes. See <a class="reference external" href="https://openzfs.github.io/openzfs-docs/Performance%20and%20Tuning/ZFS%20Transaction%20Delay.html">ZIO Transaction Delay</a> for details.</p>
<p>Code reference: <a class="reference external" href="https://github.com/openzfs/zfs/blob/master/module/zfs/vdev_queue.c#L42">vdev_queue.c</a></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ZFS%20Transaction%20Delay.html" class="btn btn-neutral float-left" title="OpenZFS Transaction Delay" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../Basic%20Concepts/index.html" class="btn btn-neutral float-right" title="Basic Concepts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, OpenZFS.
      <span class="lastupdated">Last updated on Dec 02, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>