

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>spl.4 &mdash; OpenZFS  documentation</title>
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/mandoc.css" type="text/css" />

  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=b3ba4146"></script>
      <script src="../../../_static/doctools.js?v=888ff710"></script>
      <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="zfs.4" href="zfs.4.html" />
    <link rel="prev" title="Devices and Special Files (4)" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #29667e" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/logo_main.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../Getting%20Started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Project%20and%20Community/index.html">Project and Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Developer%20Resources/index.html">Developer Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Performance%20and%20Tuning/index.html">Performance and Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Basic%20Concepts/index.html">Basic Concepts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Man Pages</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../master/index.html">master</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">v2.4</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../1/index.html">User Commands (1)</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Devices and Special Files (4)</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">spl.4</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs.4.html">zfs.4</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../5/index.html">File Formats and Conventions (5)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../7/index.html">Miscellaneous (7)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../8/index.html">System Administration Commands (8)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../v2.3/index.html">v2.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../v2.2/index.html">v2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../v2.1/index.html">v2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../v2.0/index.html">v2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../v0.8/index.html">v0.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../v0.7/index.html">v0.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../v0.6/index.html">v0.6</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../msg/index.html">ZFS Messages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../License.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #29667e" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">OpenZFS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Man Pages</a></li>
          <li class="breadcrumb-item"><a href="../index.html">v2.4</a></li>
          <li class="breadcrumb-item"><a href="index.html">Devices and Special Files (4)</a></li>
      <li class="breadcrumb-item active">spl.4</li>
      <li class="wy-breadcrumbs-aside">
              <!-- User defined GitHub URL -->
              <a href="https://github.com/openzfs/zfs/blob/zfs-2.4.99/man/man4/spl.4" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="spl-4">
<h1>spl.4<a class="headerlink" href="#spl-4" title="Permalink to this heading">ÔÉÅ</a></h1>
<div class="man_container"><table class="head">
  <tr>
    <td class="head-ltitle">SPL(4)</td>
    <td class="head-vol">Device Drivers Manual</td>
    <td class="head-rtitle">SPL(4)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">spl</code> &#x2014; <span class="Nd">parameters
    of the SPL kernel module</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<dl class="Bl-tag">
  <dt id="spl_kmem_cache_kmem_threads"><a class="permalink" href="#spl_kmem_cache_kmem_threads"><b class="Sy">spl_kmem_cache_kmem_threads</b></a>=<b class="Sy">4</b>
    (uint)</dt>
  <dd>The number of threads created for the spl_kmem_cache task queue. This task
      queue is responsible for allocating new slabs for use by the kmem caches.
      For the majority of systems and workloads only a small number of threads
      are required.</dd>
  <dt id="spl_kmem_cache_obj_per_slab"><a class="permalink" href="#spl_kmem_cache_obj_per_slab"><b class="Sy">spl_kmem_cache_obj_per_slab</b></a>=<a class="permalink" href="#8"><b class="Sy" id="8">8</b></a>
    (uint)</dt>
  <dd>The preferred number of objects per slab in the cache. In general, a
      larger value will increase the caches memory footprint while decreasing
      the time required to perform an allocation. Conversely, a smaller value
      will minimize the footprint and improve cache reclaim time but individual
      allocations may take longer.</dd>
  <dt id="spl_kmem_cache_max_size"><a class="permalink" href="#spl_kmem_cache_max_size"><b class="Sy">spl_kmem_cache_max_size</b></a>=<a class="permalink" href="#32"><b class="Sy" id="32">32</b></a>
    (64-bit) or <b class="Sy">4</b> (32-bit) (uint)</dt>
  <dd>The maximum size of a kmem cache slab in MiB. This effectively limits the
      maximum cache object size to
      <b class="Sy">spl_kmem_cache_max_size</b>/<b class="Sy">spl_kmem_cache_obj_per_slab</b>.
    <p class="Pp">Caches may not be created with object sized larger than this
        limit.</p>
  </dd>
  <dt id="spl_kmem_cache_slab_limit"><a class="permalink" href="#spl_kmem_cache_slab_limit"><b class="Sy">spl_kmem_cache_slab_limit</b></a>=<a class="permalink" href="#16384"><b class="Sy" id="16384">16384</b></a>
    (uint)</dt>
  <dd>For small objects the Linux slab allocator should be used to make the most
      efficient use of the memory. However, large objects are not supported by
      the Linux slab and therefore the SPL implementation is preferred. This
      value is used to determine the cutoff between a small and large object.
    <p class="Pp">Objects of size <b class="Sy">spl_kmem_cache_slab_limit</b> or
        smaller will be allocated using the Linux slab allocator, large objects
        use the SPL allocator. A cutoff of 16K was determined to be optimal for
        architectures using 4K pages.</p>
  </dd>
  <dt id="spl_kmem_alloc_warn"><a class="permalink" href="#spl_kmem_alloc_warn"><b class="Sy">spl_kmem_alloc_warn</b></a>=<a class="permalink" href="#32768"><b class="Sy" id="32768">32768</b></a>
    (uint)</dt>
  <dd>As a general rule
      <a class="permalink" href="#kmem_alloc"><code class="Fn" id="kmem_alloc">kmem_alloc</code></a>()
      allocations should be small, preferably just a few pages, since they must
      by physically contiguous. Therefore, a rate limited warning will be
      printed to the console for any <code class="Fn">kmem_alloc</code>() which
      exceeds a reasonable threshold.
    <p class="Pp">The default warning threshold is set to eight pages but capped
        at 32K to accommodate systems using large pages. This value was selected
        to be small enough to ensure the largest allocations are quickly noticed
        and fixed. But large enough to avoid logging any warnings when a
        allocation size is larger than optimal but not a serious concern. Since
        this value is tunable, developers are encouraged to set it lower when
        testing so any new largish allocations are quickly caught. These
        warnings may be disabled by setting the threshold to zero.</p>
  </dd>
  <dt id="spl_kmem_alloc_max"><a class="permalink" href="#spl_kmem_alloc_max"><b class="Sy">spl_kmem_alloc_max</b></a>=<b class="Sy">KMALLOC_MAX_SIZE</b>/<b class="Sy">4</b>
    (uint)</dt>
  <dd>Large
      <a class="permalink" href="#kmem_alloc~2"><code class="Fn" id="kmem_alloc~2">kmem_alloc</code></a>()
      allocations will fail if they exceed <b class="Sy">KMALLOC_MAX_SIZE</b>.
      Allocations which are marginally smaller than this limit may succeed but
      should still be avoided due to the expense of locating a contiguous range
      of free pages. Therefore, a maximum kmem size with reasonable safely
      margin of 4x is set. <code class="Fn">kmem_alloc</code>() allocations
      larger than this maximum will quickly fail.
      <a class="permalink" href="#vmem_alloc"><code class="Fn" id="vmem_alloc">vmem_alloc</code></a>()
      allocations less than or equal to this value will use
      <a class="permalink" href="#kmalloc"><code class="Fn" id="kmalloc">kmalloc</code></a>(),
      but shift to
      <a class="permalink" href="#vmalloc"><code class="Fn" id="vmalloc">vmalloc</code></a>()
      when exceeding this value.</dd>
  <dt id="spl_kmem_cache_magazine_size"><a class="permalink" href="#spl_kmem_cache_magazine_size"><b class="Sy">spl_kmem_cache_magazine_size</b></a>=<b class="Sy">0</b>
    (uint)</dt>
  <dd>Cache magazines are an optimization designed to minimize the cost of
      allocating memory. They do this by keeping a per-CPU cache of recently
      freed objects, which can then be reallocated without taking a lock. This
      can improve performance on highly contended caches. However, because
      objects in magazines will prevent otherwise empty slabs from being
      immediately released this may not be ideal for low memory machines.
    <p class="Pp">For this reason,
        <b class="Sy">spl_kmem_cache_magazine_size</b> can be used to set a
        maximum magazine size. When this value is set to 0 the magazine size
        will be automatically determined based on the object size. Otherwise
        magazines will be limited to 2-256 objects per magazine (i.e. per CPU).
        Magazines may never be entirely disabled in this implementation.</p>
  </dd>
  <dt id="spl_hostid"><a class="permalink" href="#spl_hostid"><b class="Sy">spl_hostid</b></a>=<b class="Sy">0</b>
    (ulong)</dt>
  <dd>The system hostid, when set this can be used to uniquely identify a
      system. By default this value is set to zero which indicates the hostid is
      disabled. It can be explicitly enabled by placing a unique non-zero value
      in <span class="Pa">/etc/hostid</span>.</dd>
  <dt id="spl_hostid_path"><a class="permalink" href="#spl_hostid_path"><b class="Sy">spl_hostid_path</b></a>=<span class="Pa">/etc/hostid</span>
    (charp)</dt>
  <dd>The expected path to locate the system hostid when specified. This value
      may be overridden for non-standard configurations.</dd>
  <dt id="spl_panic_halt"><a class="permalink" href="#spl_panic_halt"><b class="Sy">spl_panic_halt</b></a>=<b class="Sy">0</b>
    (uint)</dt>
  <dd>Cause a kernel panic on assertion failures. When not enabled, the thread
      is halted to facilitate further debugging.
    <p class="Pp">Set to a non-zero value to enable.</p>
  </dd>
  <dt id="spl_taskq_kick"><a class="permalink" href="#spl_taskq_kick"><b class="Sy">spl_taskq_kick</b></a>=<b class="Sy">0</b>
    (uint)</dt>
  <dd>Kick stuck taskq to spawn threads. When writing a non-zero value to it, it
      will scan all the taskqs. If any of them have a pending task more than 5
      seconds old, it will kick it to spawn more threads. This can be used if
      you find a rare deadlock occurs because one or more taskqs didn't spawn a
      thread when it should.</dd>
  <dt id="spl_taskq_thread_bind"><a class="permalink" href="#spl_taskq_thread_bind"><b class="Sy">spl_taskq_thread_bind</b></a>=<b class="Sy">0</b>
    (int)</dt>
  <dd>Bind taskq threads to specific CPUs. When enabled all taskq threads will
      be distributed evenly across the available CPUs. By default, this behavior
      is disabled to allow the Linux scheduler the maximum flexibility to
      determine where a thread should run.</dd>
  <dt id="spl_taskq_thread_dynamic"><a class="permalink" href="#spl_taskq_thread_dynamic"><b class="Sy">spl_taskq_thread_dynamic</b></a>=<b class="Sy">1</b>
    (int)</dt>
  <dd>Allow dynamic taskqs. When enabled taskqs which set the
      <a class="permalink" href="#TASKQ_DYNAMIC"><b class="Sy" id="TASKQ_DYNAMIC">TASKQ_DYNAMIC</b></a>
      flag will by default create only a single thread. New threads will be
      created on demand up to a maximum allowed number to facilitate the
      completion of outstanding tasks. Threads which are no longer needed will
      be promptly destroyed. By default this behavior is enabled but it can be
      disabled to aid performance analysis or troubleshooting.</dd>
  <dt id="spl_taskq_thread_priority"><a class="permalink" href="#spl_taskq_thread_priority"><b class="Sy">spl_taskq_thread_priority</b></a>=<b class="Sy">1</b>
    (int)</dt>
  <dd>Allow newly created taskq threads to set a non-default scheduler priority.
      When enabled, the priority specified when a taskq is created will be
      applied to all threads created by that taskq. When disabled all threads
      will use the default Linux kernel thread priority. By default, this
      behavior is enabled.</dd>
  <dt id="spl_taskq_thread_sequential"><a class="permalink" href="#spl_taskq_thread_sequential"><b class="Sy">spl_taskq_thread_sequential</b></a>=<b class="Sy">4</b>
    (int)</dt>
  <dd>The number of items a taskq worker thread must handle without interruption
      before requesting a new worker thread be spawned. This is used to control
      how quickly taskqs ramp up the number of threads processing the queue.
      Because Linux thread creation and destruction are relatively inexpensive a
      small default value has been selected. This means that normally threads
      will be created aggressively which is desirable. Increasing this value
      will result in a slower thread creation rate which may be preferable for
      some configurations.</dd>
  <dt id="spl_taskq_thread_timeout_ms"><a class="permalink" href="#spl_taskq_thread_timeout_ms"><b class="Sy">spl_taskq_thread_timeout_ms</b></a>=<a class="permalink" href="#5000"><b class="Sy" id="5000">5000</b></a>
    (uint)</dt>
  <dd>Minimum idle threads exit interval for dynamic taskqs. Smaller values
      allow idle threads exit more often and potentially be respawned again on
      demand, causing more churn.</dd>
</dl>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">August 24, 2020</td>
    <td class="foot-os">Debian</td>
  </tr>
</table>
</div></section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Devices and Special Files (4)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="zfs.4.html" class="btn btn-neutral float-right" title="zfs.4" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, OpenZFS.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>