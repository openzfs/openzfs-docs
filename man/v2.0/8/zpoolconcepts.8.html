

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>zpoolconcepts.8 &mdash; OpenZFS  documentation</title>
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/mandoc.css" type="text/css" />

  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=b3ba4146"></script>
      <script src="../../../_static/doctools.js?v=888ff710"></script>
      <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="zpoolprops.8" href="zpoolprops.8.html" />
    <link rel="prev" title="zpool.8" href="zpool.8.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #29667e" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/logo_main.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../Getting%20Started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Project%20and%20Community/index.html">Project and Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Developer%20Resources/index.html">Developer Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Performance%20and%20Tuning/index.html">Performance and Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Basic%20Concepts/index.html">Basic Concepts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Man Pages</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../master/index.html">master</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../v2.4/index.html">v2.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../v2.3/index.html">v2.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../v2.2/index.html">v2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../v2.1/index.html">v2.1</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">v2.0</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../1/index.html">User Commands (1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../5/index.html">File Formats and Conventions (5)</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">System Administration Commands (8)</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="fsck.zfs.8.html">fsck.zfs.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="mount.zfs.8.html">mount.zfs.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="vdev_id.8.html">vdev_id.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zdb.8.html">zdb.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zed.8.html">zed.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-allow.8.html">zfs-allow.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-bookmark.8.html">zfs-bookmark.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-change-key.8.html">zfs-change-key.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-clone.8.html">zfs-clone.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-create.8.html">zfs-create.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-destroy.8.html">zfs-destroy.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-diff.8.html">zfs-diff.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-get.8.html">zfs-get.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-groupspace.8.html">zfs-groupspace.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-hold.8.html">zfs-hold.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-inherit.8.html">zfs-inherit.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-jail.8.html">zfs-jail.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-list.8.html">zfs-list.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-load-key.8.html">zfs-load-key.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-mount-generator.8.html">zfs-mount-generator.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-mount.8.html">zfs-mount.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-program.8.html">zfs-program.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-project.8.html">zfs-project.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-projectspace.8.html">zfs-projectspace.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-promote.8.html">zfs-promote.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-receive.8.html">zfs-receive.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-recv.8.html">zfs-recv.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-redact.8.html">zfs-redact.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-release.8.html">zfs-release.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-rename.8.html">zfs-rename.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-rollback.8.html">zfs-rollback.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-send.8.html">zfs-send.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-set.8.html">zfs-set.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-share.8.html">zfs-share.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-snapshot.8.html">zfs-snapshot.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-unallow.8.html">zfs-unallow.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-unjail.8.html">zfs-unjail.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-unload-key.8.html">zfs-unload-key.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-unmount.8.html">zfs-unmount.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-upgrade.8.html">zfs-upgrade.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-userspace.8.html">zfs-userspace.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs-wait.8.html">zfs-wait.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs.8.html">zfs.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfs_ids_to_path.8.html">zfs_ids_to_path.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfsconcepts.8.html">zfsconcepts.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zfsprops.8.html">zfsprops.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zgenhostid.8.html">zgenhostid.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zinject.8.html">zinject.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-add.8.html">zpool-add.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-attach.8.html">zpool-attach.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-checkpoint.8.html">zpool-checkpoint.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-clear.8.html">zpool-clear.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-create.8.html">zpool-create.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-destroy.8.html">zpool-destroy.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-detach.8.html">zpool-detach.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-events.8.html">zpool-events.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-export.8.html">zpool-export.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-get.8.html">zpool-get.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-history.8.html">zpool-history.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-import.8.html">zpool-import.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-initialize.8.html">zpool-initialize.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-iostat.8.html">zpool-iostat.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-labelclear.8.html">zpool-labelclear.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-list.8.html">zpool-list.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-offline.8.html">zpool-offline.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-online.8.html">zpool-online.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-reguid.8.html">zpool-reguid.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-remove.8.html">zpool-remove.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-reopen.8.html">zpool-reopen.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-replace.8.html">zpool-replace.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-resilver.8.html">zpool-resilver.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-scrub.8.html">zpool-scrub.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-set.8.html">zpool-set.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-split.8.html">zpool-split.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-status.8.html">zpool-status.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-sync.8.html">zpool-sync.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-trim.8.html">zpool-trim.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-upgrade.8.html">zpool-upgrade.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool-wait.8.html">zpool-wait.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpool.8.html">zpool.8</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">zpoolconcepts.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zpoolprops.8.html">zpoolprops.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zstream.8.html">zstream.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="zstreamdump.8.html">zstreamdump.8</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../v0.8/index.html">v0.8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../v0.7/index.html">v0.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../v0.6/index.html">v0.6</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../msg/index.html">ZFS Messages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../License.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #29667e" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">OpenZFS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Man Pages</a></li>
          <li class="breadcrumb-item"><a href="../index.html">v2.0</a></li>
          <li class="breadcrumb-item"><a href="index.html">System Administration Commands (8)</a></li>
      <li class="breadcrumb-item active">zpoolconcepts.8</li>
      <li class="wy-breadcrumbs-aside">
              <!-- User defined GitHub URL -->
              <a href="https://github.com/openzfs/zfs/blob/zfs-2.0.7/man/man8/zpoolconcepts.8" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="zpoolconcepts-8">
<h1>zpoolconcepts.8<a class="headerlink" href="#zpoolconcepts-8" title="Permalink to this heading"></a></h1>
<div class="man_container"><table class="head">
  <tr>
    <td class="head-ltitle">ZPOOLCONCEPTS(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">ZPOOLCONCEPTS(8)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
<p class="Pp"><code class="Nm">zpoolconcepts</code> &#x2014;
    <span class="Nd">overview of ZFS storage pools</span></p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<section class="Ss">
<h2 class="Ss" id="Virtual_Devices_(vdevs)"><a class="permalink" href="#Virtual_Devices_(vdevs)">Virtual
  Devices (vdevs)</a></h2>
<p class="Pp">A &quot;virtual device&quot; describes a single device or a
    collection of devices organized according to certain performance and fault
    characteristics. The following virtual devices are supported:</p>
<dl class="Bl-tag">
  <dt id="disk"><a class="permalink" href="#disk"><b class="Sy">disk</b></a></dt>
  <dd>A block device, typically located under <span class="Pa">/dev</span>. ZFS
      can use individual slices or partitions, though the recommended mode of
      operation is to use whole disks. A disk can be specified by a full path,
      or it can be a shorthand name (the relative portion of the path under
      <span class="Pa">/dev</span>). A whole disk can be specified by omitting
      the slice or partition designation. For example,
      <span class="Pa">sda</span> is equivalent to
      <span class="Pa">/dev/sda</span>. When given a whole disk, ZFS
      automatically labels the disk, if necessary.</dd>
  <dt id="file"><a class="permalink" href="#file"><b class="Sy">file</b></a></dt>
  <dd>A regular file. The use of files as a backing store is strongly
      discouraged. It is designed primarily for experimental purposes, as the
      fault tolerance of a file is only as good as the file system of which it
      is a part. A file must be specified by a full path.</dd>
  <dt id="mirror"><a class="permalink" href="#mirror"><b class="Sy">mirror</b></a></dt>
  <dd>A mirror of two or more devices. Data is replicated in an identical
      fashion across all components of a mirror. A mirror with N disks of size X
      can hold X bytes and can withstand (N-1) devices failing before data
      integrity is compromised.</dd>
  <dt id="raidz"><a class="permalink" href="#raidz"><b class="Sy">raidz</b></a>,
    <b class="Sy">raidz1</b>, <b class="Sy">raidz2</b>,
    <b class="Sy">raidz3</b></dt>
  <dd>A variation on RAID-5 that allows for better distribution of parity and
      eliminates the RAID-5 &quot;write hole&quot; (in which data and parity
      become inconsistent after a power loss). Data and parity is striped across
      all disks within a raidz group.
    <p class="Pp">A raidz group can have single-, double-, or triple-parity,
        meaning that the raidz group can sustain one, two, or three failures,
        respectively, without losing any data. The <b class="Sy">raidz1</b> vdev
        type specifies a single-parity raidz group; the <b class="Sy">raidz2</b>
        vdev type specifies a double-parity raidz group; and the
        <b class="Sy">raidz3</b> vdev type specifies a triple-parity raidz
        group. The <b class="Sy">raidz</b> vdev type is an alias for
        <b class="Sy">raidz1</b>.</p>
    <p class="Pp">A raidz group with N disks of size X with P parity disks can
        hold approximately (N-P)*X bytes and can withstand P device(s) failing
        before data integrity is compromised. The minimum number of devices in a
        raidz group is one more than the number of parity disks. The recommended
        number is between 3 and 9 to help increase performance.</p>
  </dd>
  <dt id="spare"><a class="permalink" href="#spare"><b class="Sy">spare</b></a></dt>
  <dd>A pseudo-vdev which keeps track of available hot spares for a pool. For
      more information, see the <a class="Sx" href="#Hot_Spares">Hot Spares</a>
      section.</dd>
  <dt id="log"><a class="permalink" href="#log"><b class="Sy">log</b></a></dt>
  <dd>A separate intent log device. If more than one log device is specified,
      then writes are load-balanced between devices. Log devices can be
      mirrored. However, raidz vdev types are not supported for the intent log.
      For more information, see the <a class="Sx" href="#Intent_Log">Intent
      Log</a> section.</dd>
  <dt id="dedup"><a class="permalink" href="#dedup"><b class="Sy">dedup</b></a></dt>
  <dd>A device dedicated solely for deduplication tables. The redundancy of this
      device should match the redundancy of the other normal devices in the
      pool. If more than one dedup device is specified, then allocations are
      load-balanced between those devices.</dd>
  <dt id="special"><a class="permalink" href="#special"><b class="Sy">special</b></a></dt>
  <dd>A device dedicated solely for allocating various kinds of internal
      metadata, and optionally small file blocks. The redundancy of this device
      should match the redundancy of the other normal devices in the pool. If
      more than one special device is specified, then allocations are
      load-balanced between those devices.
    <p class="Pp">For more information on special allocations, see the
        <a class="Sx" href="#Special_Allocation_Class">Special Allocation
        Class</a> section.</p>
  </dd>
  <dt id="cache"><a class="permalink" href="#cache"><b class="Sy">cache</b></a></dt>
  <dd>A device used to cache storage pool data. A cache device cannot be
      configured as a mirror or raidz group. For more information, see the
      <a class="Sx" href="#Cache_Devices">Cache Devices</a> section.</dd>
</dl>
<p class="Pp">Virtual devices cannot be nested, so a mirror or raidz virtual
    device can only contain files or disks. Mirrors of mirrors (or other
    combinations) are not allowed.</p>
<p class="Pp">A pool can have any number of virtual devices at the top of the
    configuration (known as &quot;root vdevs&quot;). Data is dynamically
    distributed across all top-level devices to balance data among devices. As
    new virtual devices are added, ZFS automatically places data on the newly
    available devices.</p>
<p class="Pp">Virtual devices are specified one at a time on the command line,
    separated by whitespace. The keywords <b class="Sy">mirror</b> and
    <b class="Sy">raidz</b> are used to distinguish where a group ends and
    another begins. For example, the following creates two root vdevs, each a
    mirror of two disks:</p>
<div class="Bd Pp Li">
<pre># zpool create mypool mirror sda sdb mirror sdc sdd</pre>
</div>
</section>
<section class="Ss">
<h2 class="Ss" id="Device_Failure_and_Recovery"><a class="permalink" href="#Device_Failure_and_Recovery">Device
  Failure and Recovery</a></h2>
<p class="Pp">ZFS supports a rich set of mechanisms for handling device failure
    and data corruption. All metadata and data is checksummed, and ZFS
    automatically repairs bad data from a good copy when corruption is
  detected.</p>
<p class="Pp">In order to take advantage of these features, a pool must make use
    of some form of redundancy, using either mirrored or raidz groups. While ZFS
    supports running in a non-redundant configuration, where each root vdev is
    simply a disk or file, this is strongly discouraged. A single case of bit
    corruption can render some or all of your data unavailable.</p>
<p class="Pp">A pool's health status is described by one of three states:
    online, degraded, or faulted. An online pool has all devices operating
    normally. A degraded pool is one in which one or more devices have failed,
    but the data is still available due to a redundant configuration. A faulted
    pool has corrupted metadata, or one or more faulted devices, and
    insufficient replicas to continue functioning.</p>
<p class="Pp">The health of the top-level vdev, such as mirror or raidz device,
    is potentially impacted by the state of its associated vdevs, or component
    devices. A top-level vdev or component device is in one of the following
    states:</p>
<dl class="Bl-tag">
  <dt id="DEGRADED"><a class="permalink" href="#DEGRADED"><b class="Sy">DEGRADED</b></a></dt>
  <dd>One or more top-level vdevs is in the degraded state because one or more
      component devices are offline. Sufficient replicas exist to continue
      functioning.
    <p class="Pp">One or more component devices is in the degraded or faulted
        state, but sufficient replicas exist to continue functioning. The
        underlying conditions are as follows:</p>
    <ul class="Bl-bullet">
      <li>The number of checksum errors exceeds acceptable levels and the device
          is degraded as an indication that something may be wrong. ZFS
          continues to use the device as necessary.</li>
      <li>The number of I/O errors exceeds acceptable levels. The device could
          not be marked as faulted because there are insufficient replicas to
          continue functioning.</li>
    </ul>
  </dd>
  <dt id="FAULTED"><a class="permalink" href="#FAULTED"><b class="Sy">FAULTED</b></a></dt>
  <dd>One or more top-level vdevs is in the faulted state because one or more
      component devices are offline. Insufficient replicas exist to continue
      functioning.
    <p class="Pp">One or more component devices is in the faulted state, and
        insufficient replicas exist to continue functioning. The underlying
        conditions are as follows:</p>
    <ul class="Bl-bullet">
      <li>The device could be opened, but the contents did not match expected
          values.</li>
      <li>The number of I/O errors exceeds acceptable levels and the device is
          faulted to prevent further use of the device.</li>
    </ul>
  </dd>
  <dt id="OFFLINE"><a class="permalink" href="#OFFLINE"><b class="Sy">OFFLINE</b></a></dt>
  <dd>The device was explicitly taken offline by the
      <code class="Nm">zpool</code> <code class="Cm">offline</code>
    command.</dd>
  <dt id="ONLINE"><a class="permalink" href="#ONLINE"><b class="Sy">ONLINE</b></a></dt>
  <dd>The device is online and functioning.</dd>
  <dt id="REMOVED"><a class="permalink" href="#REMOVED"><b class="Sy">REMOVED</b></a></dt>
  <dd>The device was physically removed while the system was running. Device
      removal detection is hardware-dependent and may not be supported on all
      platforms.</dd>
  <dt id="UNAVAIL"><a class="permalink" href="#UNAVAIL"><b class="Sy">UNAVAIL</b></a></dt>
  <dd>The device could not be opened. If a pool is imported when a device was
      unavailable, then the device will be identified by a unique identifier
      instead of its path since the path was never correct in the first
    place.</dd>
</dl>
<p class="Pp">If a device is removed and later re-attached to the system, ZFS
    attempts to put the device online automatically. Device attach detection is
    hardware-dependent and might not be supported on all platforms.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Hot_Spares"><a class="permalink" href="#Hot_Spares">Hot
  Spares</a></h2>
<p class="Pp">ZFS allows devices to be associated with pools as &quot;hot
    spares&quot;. These devices are not actively used in the pool, but when an
    active device fails, it is automatically replaced by a hot spare. To create
    a pool with hot spares, specify a <b class="Sy">spare</b> vdev with any
    number of devices. For example,</p>
<div class="Bd Pp Li">
<pre># zpool create pool mirror sda sdb spare sdc sdd</pre>
</div>
<p class="Pp">Spares can be shared across multiple pools, and can be added with
    the <code class="Nm">zpool</code> <code class="Cm">add</code> command and
    removed with the <code class="Nm">zpool</code>
    <code class="Cm">remove</code> command. Once a spare replacement is
    initiated, a new <b class="Sy">spare</b> vdev is created within the
    configuration that will remain there until the original device is replaced.
    At this point, the hot spare becomes available again if another device
    fails.</p>
<p class="Pp">If a pool has a shared spare that is currently being used, the
    pool can not be exported since other pools may use this shared spare, which
    may lead to potential data corruption.</p>
<p class="Pp">Shared spares add some risk. If the pools are imported on
    different hosts, and both pools suffer a device failure at the same time,
    both could attempt to use the spare at the same time. This may not be
    detected, resulting in data corruption.</p>
<p class="Pp">An in-progress spare replacement can be cancelled by detaching the
    hot spare. If the original faulted device is detached, then the hot spare
    assumes its place in the configuration, and is removed from the spare list
    of all active pools.</p>
<p class="Pp">Spares cannot replace log devices.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Intent_Log"><a class="permalink" href="#Intent_Log">Intent
  Log</a></h2>
<p class="Pp">The ZFS Intent Log (ZIL) satisfies POSIX requirements for
    synchronous transactions. For instance, databases often require their
    transactions to be on stable storage devices when returning from a system
    call. NFS and other applications can also use <a class="Xr">fsync(2)</a> to
    ensure data stability. By default, the intent log is allocated from blocks
    within the main pool. However, it might be possible to get better
    performance using separate intent log devices such as NVRAM or a dedicated
    disk. For example:</p>
<div class="Bd Pp Li">
<pre># zpool create pool sda sdb log sdc</pre>
</div>
<p class="Pp">Multiple log devices can also be specified, and they can be
    mirrored. See the <a class="Sx" href="#EXAMPLES">EXAMPLES</a> section for an
    example of mirroring multiple log devices.</p>
<p class="Pp">Log devices can be added, replaced, attached, detached and
    removed. In addition, log devices are imported and exported as part of the
    pool that contains them. Mirrored devices can be removed by specifying the
    top-level mirror vdev.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Cache_Devices"><a class="permalink" href="#Cache_Devices">Cache
  Devices</a></h2>
<p class="Pp">Devices can be added to a storage pool as &quot;cache
    devices&quot;. These devices provide an additional layer of caching between
    main memory and disk. For read-heavy workloads, where the working set size
    is much larger than what can be cached in main memory, using cache devices
    allow much more of this working set to be served from low latency media.
    Using cache devices provides the greatest performance improvement for random
    read-workloads of mostly static content.</p>
<p class="Pp">To create a pool with cache devices, specify a
    <b class="Sy">cache</b> vdev with any number of devices. For example:</p>
<div class="Bd Pp Li">
<pre># zpool create pool sda sdb cache sdc sdd</pre>
</div>
<p class="Pp">Cache devices cannot be mirrored or part of a raidz configuration.
    If a read error is encountered on a cache device, that read I/O is reissued
    to the original storage pool device, which might be part of a mirrored or
    raidz configuration.</p>
<p class="Pp" id="l2arc_rebuild_enabled">The content of the cache devices is
    persistent across reboots and restored asynchronously when importing the
    pool in L2ARC (persistent L2ARC). This can be disabled by setting
    <a class="permalink" href="#l2arc_rebuild_enabled"><b class="Sy">l2arc_rebuild_enabled
    = 0</b></a>. For cache devices smaller than 1GB we do not write the metadata
    structures required for rebuilding the L2ARC in order not to waste space.
    This can be changed with
    <a class="permalink" href="#l2arc_rebuild_blocks_min_l2size"><b class="Sy" id="l2arc_rebuild_blocks_min_l2size">l2arc_rebuild_blocks_min_l2size</b></a>.
    The cache device header (512 bytes) is updated even if no metadata
    structures are written. Setting
    <a class="permalink" href="#l2arc_headroom"><b class="Sy" id="l2arc_headroom">l2arc_headroom
    = 0</b></a> will result in scanning the full-length ARC lists for cacheable
    content to be written in L2ARC (persistent ARC). If a cache device is added
    with <code class="Nm">zpool</code> <code class="Cm">add</code> its label and
    header will be overwritten and its contents are not going to be restored in
    L2ARC, even if the device was previously part of the pool. If a cache device
    is onlined with <code class="Nm">zpool</code> <code class="Cm">online</code>
    its contents will be restored in L2ARC. This is useful in case of memory
    pressure where the contents of the cache device are not fully restored in
    L2ARC. The user can off/online the cache device when there is less memory
    pressure in order to fully restore its contents to L2ARC.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Pool_checkpoint"><a class="permalink" href="#Pool_checkpoint">Pool
  checkpoint</a></h2>
<p class="Pp">Before starting critical procedures that include destructive
    actions (e.g <code class="Nm">zfs</code> <code class="Cm">destroy</code> ),
    an administrator can checkpoint the pool's state and in the case of a
    mistake or failure, rewind the entire pool back to the checkpoint.
    Otherwise, the checkpoint can be discarded when the procedure has completed
    successfully.</p>
<p class="Pp">A pool checkpoint can be thought of as a pool-wide snapshot and
    should be used with care as it contains every part of the pool's state, from
    properties to vdev configuration. Thus, while a pool has a checkpoint
    certain operations are not allowed. Specifically, vdev
    removal/attach/detach, mirror splitting, and changing the pool's guid.
    Adding a new vdev is supported but in the case of a rewind it will have to
    be added again. Finally, users of this feature should keep in mind that
    scrubs in a pool that has a checkpoint do not repair checkpointed data.</p>
<p class="Pp">To create a checkpoint for a pool:</p>
<div class="Bd Pp Li">
<pre># zpool checkpoint pool</pre>
</div>
<p class="Pp">To later rewind to its checkpointed state, you need to first
    export it and then rewind it during import:</p>
<div class="Bd Pp Li">
<pre># zpool export pool
# zpool import --rewind-to-checkpoint pool</pre>
</div>
<p class="Pp">To discard the checkpoint from a pool:</p>
<div class="Bd Pp Li">
<pre># zpool checkpoint -d pool</pre>
</div>
<p class="Pp">Dataset reservations (controlled by the
    <code class="Nm">reservation</code> or
    <code class="Nm">refreservation</code> zfs properties) may be unenforceable
    while a checkpoint exists, because the checkpoint is allowed to consume the
    dataset's reservation. Finally, data that is part of the checkpoint but has
    been freed in the current state of the pool won't be scanned during a
  scrub.</p>
</section>
<section class="Ss">
<h2 class="Ss" id="Special_Allocation_Class"><a class="permalink" href="#Special_Allocation_Class">Special
  Allocation Class</a></h2>
<p class="Pp">The allocations in the special class are dedicated to specific
    block types. By default this includes all metadata, the indirect blocks of
    user data, and any deduplication tables. The class can also be provisioned
    to accept small file blocks.</p>
<p class="Pp">A pool must always have at least one normal (non-dedup/special)
    vdev before other devices can be assigned to the special class. If the
    special class becomes full, then allocations intended for it will spill back
    into the normal class.</p>
<p class="Pp" id="zfs_ddt_data_is_special">Deduplication tables can be excluded
    from the special class by setting the
    <a class="permalink" href="#zfs_ddt_data_is_special"><b class="Sy">zfs_ddt_data_is_special</b></a>
    zfs module parameter to false (0).</p>
<p class="Pp" id="special_small_blocks">Inclusion of small file blocks in the
    special class is opt-in. Each dataset can control the size of small file
    blocks allowed in the special class by setting the
    <a class="permalink" href="#special_small_blocks"><b class="Sy">special_small_blocks</b></a>
    dataset property. It defaults to zero, so you must opt-in by setting it to a
    non-zero value. See <a href="../8/zfs.8.html" class="Xr">zfs(8)</a> for more info on setting this
    property.</p>
</section>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">August 9, 2019</td>
    <td class="foot-os">Debian</td>
  </tr>
</table>
</div></section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="zpool.8.html" class="btn btn-neutral float-left" title="zpool.8" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="zpoolprops.8.html" class="btn btn-neutral float-right" title="zpoolprops.8" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, OpenZFS.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>